version: 0.2
env:
  parameter-store:
    PASS: "/CodeBuild/Access_Key"
phases:
  # build:
  #   commands:
  #     - echo "building"
  #     - docker --version
  #     - mvn --help 
  pre_build:
    commands:
      - echo $PASS > test.pem
      - echo "running"
      - ssh -i "test.pem" ec2-user@ec2-54-88-140-43.compute-1.amazonaws.com
  build:
    commands:
      - ssh -i "test.pem" ec2-user@ec2-18-213-1-85.compute-1.amazonaws.com
      - echo "Cloning Github repo"
      - git clone https://github.com/AnonyIIMessiah/Fleetman_cicd.git
      - cd Fleetman_cicd/k8s
      - echo "Applying Changes in YAML file"
      - kubectl apply -f .
  post_build:
    commands:
      - echo "Build completed successfully"


